#!/bin/bash

cat $1 | sed '1d' | sed '4d' | sed -e $'s/KBPair: {/KBPair: {\\\n/g' | sed -E 's/@ ([0-9]*),/@ \1!/g' | sed -e $'s/!/\\\n,\\\n/g' | sed -e $'s/@ ([0-9]*)}/\\\n}/g' > tmp

cat tmp | sed -E 's/reduce in SCENARIO-DIAGNOSIS :/%/g' | sed '2,3d' | sed '3,5d' > $2
cat tmp | sed -E 's/reduce in SCENARIO-DIAGNOSIS :/%/g' | sed '2,3d' | sed '2,3d' | sed '3d' | sed '$ s/.$//' > $3
rm tmp

cat $2 | sed '1d' | \
  sed -E 's/atloc\(b\(([0-9]*)\), pt\(([0-9]*), ([0-9]*), ([0-9]*)\)\) @ ([0-9]*)/\1, \2, \3, \4, \5/g' | \
  sed -E 's/atloc\(ob\(([0-9]*)\), pt\(([0-9]*), ([0-9]*), ([0-9]*)\)\) @ ([0-9]*)/3, \2, \3, \4, \5/g' | \
  sed -E 's/\(([0-9]*), ([0-9]*), ([0-9]*), ([0-9]*), ([0-9]*)\)/\1, \2, \3, \4, \5;/g' | \
  sed -E 's/\(energy\(b\(([0-9]*)\), ([-+]?[0-9]*.[0-9]*[eE][-+]?[0-9]+)\) @ ([0-9]*)\)/;/g' | \
  sed -E 's/energy\(b\(([0-9]*)\), ([-+]?[0-9]*.[0-9]*[eE][-+]?[0-9]+)\) @ ([0-9]*)/;/g' | \
  sed -E 's/\(energy\(b\(([0-9]*)\), ([-+]?[0-9]*.[0-9]*)\) @ ([0-9]*)\)/;/g' | \
  sed -E 's/energy\(b\(([0-9]*)\), ([-+]?[0-9]*.[0-9]*)\) @ ([0-9]*)/;/g' | \
  sed -e $'s/;/\\\n/g' | sed $'1 s/^/0, 2, 2, 0, 0\\\n/' | sed $'1 s/^/1, 98, 98, 0, 0\\\n/' | \
  sed -e $'s/;/\\\n/g' | sed $'1 s/^/2, 10, 80, 25, 0\\\n/' | sed $'1 s/^/2, 80, 20, 25, 1\\\n/' | \
  sed -e $'s/;/\\\n/g' | sed $'1 s/^/2, 90, 29, 35, 0\\\n/' | sed $'1 s/^/2, 20, 90, 35, 1\\\n/' | \
  sed $'1 s/^/bot, x, y, z, t\\\n/' | sed '/^ *$/d' > $4 
